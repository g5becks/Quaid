[tools]
actionlint        = "latest"
"cargo:ck-search" = "latest"
goreleaser        = "latest"
lefthook          = "latest"
ls-lint           = "latest"
ruff              = "latest"
shellcheck        = "latest"
shfmt             = "latest"
taplo             = "latest"
uv                = "latest"
yamlfmt           = "latest"
yamllint          = "latest"

[tasks]
# Individual linter tasks
[tasks."lint:yml"]
description = "Lint YAML files with yamllint"
run = "yamllint .yamllint.yml"

[tasks."lint:toml"]
description = "Lint TOML files with taplo"
run = "taplo check *.toml"

[tasks."lint:sh"]
description = "Lint shell scripts with shellcheck"
run = "find . -name '*.sh' -o -name '*.bash' ! -path './claude-self-reflect/*' | xargs shellcheck --severity=warning"

[tasks."lint:py"]
description = "Lint Python files with ruff"
run = "ruff check ."

[tasks."lint:upgrade"]
description = "Upgrade Python syntax with pyupgrade"
run = "find packages/ -name '*.py' -exec uv run pyupgrade --py314-plus {} +"

[tasks."lint:dead"]
description = "Find dead code with vulture"
run = "uv run vulture"

[tasks."lint:naming"]
description = "Check file naming conventions with ls-lint"
run = "ls-lint ."

# Individual formatter tasks
[tasks."fix:yml"]
description = "Format YAML files with yamlfmt"
run = "yamlfmt ."

[tasks."fix:toml"]
description = "Format TOML files with taplo"
run = "taplo fmt *.toml"

[tasks."fix:sh"]
description = "Format shell scripts with shfmt"
run = "find . -name '*.sh' -o -name '*.bash' | xargs shfmt -w -i 2 -sr"

[tasks."fix:py"]
description = "Format Python files with ruff"
run = "ruff format ."

[tasks."fix:upgrade"]
description = "Upgrade and format Python files"
run = '''
echo "ğŸ”„ Upgrading Python syntax..."
find packages/ -name '*.py' -exec uv run pyupgrade --py314-plus {} +
echo "ğŸ“ Formatting Python files..."
mise run fix:py
echo "âœ… Python upgrade and formatting completed!"
'''

# Combined tasks
[tasks."lint:all"]
description = "Run all linters on the entire project"
run = '''
echo "ğŸ” Running all linters..."
mise run lint:naming
mise run lint:yml
mise run lint:toml
mise run lint:sh
mise run lint:py
mise run lint:upgrade
mise run lint:dead
echo "âœ… All linters completed!"
'''

[tasks."fix:all"]
description = "Format and fix all files in the project"
run = '''
echo "ğŸ”§ Running all formatters and fixes..."
mise run fix:yml
mise run fix:toml
mise run fix:sh
mise run fix:py
mise run fix:upgrade
echo "âœ… All formatting and fixes completed!"
'''

[tasks."check:all"]
description = "Run comprehensive check (lint + fix) on the project"
depends = ["fix:all", "lint:all"]
run = "echo 'ğŸ‰ Comprehensive check completed!'"

# Convenience aliases
[tasks.lint]
description = "Alias for lint:all"
alias = "lint:all"

[tasks.fix]
description = "Alias for fix:all"
alias = "fix:all"

[tasks.check]
description = "Alias for check:all"
alias = "check:all"

# Development workflow tasks
[tasks."dev:setup"]
description = "Set up development environment"
run = '''
echo "ğŸš€ Setting up Quaid development environment..."
mise install
mise run lint:all
echo "âœ… Development environment ready!"
'''

[tasks."dev:watch"]
description = "Watch for changes and run linting"
run = '''
echo "ğŸ‘€ Watching for changes..."
mise watch lint:all
'''

[tasks."pre-commit:check"]
description = "Run the same checks as pre-commit hooks"
run = '''
echo "ğŸª Running pre-commit checks..."
mise exec lefthook -- lefthook run pre-commit
'''

# Testing tasks
[tasks.test]
description = "Run tests"
run = '''
echo "ğŸ§ª Running tests..."
uv run pytest
'''

[tasks."test:watch"]
description = "Watch for changes and run tests"
run = '''
echo "ğŸ§ª Watching for test changes..."
mise watch test
'''
